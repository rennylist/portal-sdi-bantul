<script type="text/javascript">
    $(document).ready(function () {
        //edit foto
        $(".edit").click(function () {
            $('#modal_edit').modal('show');
        });
        $(".file-styled").uniform({
            fileButtonClass: 'action btn btn-dark'
        });
    });
</script>
<section class="content">
    <!-- notification template -->
    {include file="base/templates/notification.html"}
    <!-- end of notification template-->
    <div class="row">
        <div class="col-12">
            <div class="box">
                <div class="content-main " id="content-main">
                    <div>
                        <div class="item">
                            <div class="item-bg">
                                <img src="{$com_user.user_img}" alt="" class="blur opacity-3" />
                            </div>
                            <div class="p-4">
                                <div class="row mt-3">
                                    <div class="col-sm-7">
                                        <div class="media">
                                            <div class="avatar w-96">
                                                <div class="profile-img-container">
                                                    <img class="profile-img img-circle img-responsive" src="{$com_user.user_img}" alt="" />
                                                    <a class="edit" href="#">
                                                        <span class="fa fa-upload fa-4x"></span>
                                                    </a>                                           
                                                </div>
                                            </div>
                                            <div class="media-body mx-3 mb-2">
                                                <h4>
                                                    {$com_user.nama_lengkap|default:''}
                                                </h4>
                                                <p>
                                                    <span class="text-success">
                                                        Developer
                                                    </span> 
                                                    <small class="text-danger">{$com_user.struktur_nama|default:'Jaring Aspirasi - DPRD Kabupaten Bantul'}</small>
                                                </p>
                                                <p class="text-muted"><span class="m-r">{$com_user.user_mail|default:'-'}</span></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="white bg b-b px-3">
                            <div class="row">
                                <div class="col-sm-6 order-sm-1">
                                    <div class="py-4 clearfix nav-active-theme">
                                        <ul class="nav nav-pills nav-sm">
                                            <li class="nav-item mr-2">
                                                <a class="btn btn-md btn-info" href="{$config->site_url('settings/welcome/profile')}">
                                                    <i class="fa fa-user mr-2"></i>
                                                    Data Pribadi
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="btn btn-md btn-dark active" href="{$config->site_url('settings/welcome/profile/account_settings')}">
                                                    <i class="fa fa-key mr-2"></i>
                                                    Ganti Password
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="padding">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="tab-content">
                                        <div class="box-body">  
                                            <form action="{$config->site_url('settings/welcome/profile/edit_account_process')}" method="post" id="form" data-plugin="parsley" data-option="{}" novalidate="" class="form-horizontal adminex-form">      
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <label class="col-sm-3 control-label">Password Saat Ini</label>
                                                            <div class="col-sm-5">
                                                                <input type="password" name="old_pass" value="" class="form-control" autocomplete="off" placeholder="Masukkan password lama anda disini." required="required" />
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label class="col-sm-3 control-label">Password Baru</label>
                                                            <div class="col-sm-5">
                                                                <input type="password" name="user_pass" id="password" value="" class="form-control" autocomplete="off" placeholder="Minimal 8 Karakter, Maksimal 20 Karakter" required="required" />
                                                                <!-- <input id="password" name="password" type="password" placeholder="" class="form-control input-md" data-placement="bottom" data-toggle="popover" data-container="body" type="button" data-html="true"> -->
                                                                Kekuatan : <span id="result"> </span>
                                                                <br />
                                                                <div class="progress" style="margin-top: 5px;">
                                                                    <div id="password-strength" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:0%">
                                                                    </div>
                                                                </div>
                                                                <ul class="list-unstyled">
                                                                    <li class=""><span class="low-upper-case"><i class="fa fa-file-text" aria-hidden="true"></i></span>&nbsp; Harus memuat paling sedikit 1 huruf kecil dan 1 huruf besar</li>
                                                                    <li class=""><span class="one-number"><i class="fa fa-file-text" aria-hidden="true"></i></span> &nbsp;Harus memuat paling sedikit 1 angka (0-9)</li>
                                                                    <li class=""><span class="one-special-char"><i class="fa fa-file-text" aria-hidden="true"></i></span> &nbsp;Harus memuat paling sedikit 1 karakter spesial (!@#$%^&*)</li>
                                                                    <li class=""><span class="eight-character"><i class="fa fa-file-text" aria-hidden="true"></i></span>&nbsp; Minimal password 8 karakter</li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label class="col-sm-3 control-label">Konfirmasi Password Baru</label>
                                                            <div class="col-sm-5">
                                                                <!-- <input type="password" name="confirm_user_pass" value="" class="form-control" autocomplete="off" placeholder="Masukkan kembali password baru anda disini." required="required" /> -->
                                                                <input type="password" name="confirm_user_pass" id="confirm-password" value="" class="form-control" autocomplete="off" placeholder="Masukkan kembali password baru anda disini." required="required" />
                                                                <span id="popover-cpassword" class="block-help"><i class="fa fa-info-circle text-danger" aria-hidden="true"></i> Password tidak sama</span>
                
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="col-sm-12">
                                                                <label class="md-check">
                                                                    <input value="yes" name="send_mail" type="checkbox" /> 
                                                                    <i class="blue"></i>
                                                                    Kirim perubahan password ke <b>{$com_user.user_mail|default:'-'}</b>.
                                                                </label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <br />
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="form-group">
                                                            <div class="col-md-12">
                                                                <button type="submit" class="btn btn-success" id="sign-up"><i class="fa fa-check mr-2"></i> Update</button> &nbsp
                                                                <button type="reset" class="btn btn-default"><i class="fa fa-times mr-2"></i> Reset</button>
                                                            </div>
                                                        </div>                                         
                                                    </div>
                                                </div>                                                
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Modal Update Foto Pofil -->
<div class="modal fade" id="modal_edit" role="dialog"  aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content box-shadow-md mb-3">
            <div class="modal-header">
                <h5 class="modal-title">Upload Foto Profil</h5>
            </div>
            <form class="form-horizontal" action="{$config->site_url('settings/welcome/profile/edit_foto_process')}" method="post" enctype="multipart/form-data">
                <div class="modal-body">
                    <input name="page" type="hidden" value="password" />
                    <div class="form-group row">
                        <label class="col-md-3 col-form-label">Browse Foto</label>
                        <div class="col-md-8">
                            <div class="form-file">
                                <input type="file" name="user_img_upload" class="form-control file-styled" />
                            </div>
                        </div>
                    </div>
                    <!--Modal footer-->
                    <div class="modal-footer">
                        <button data-dismiss="modal" class="btn dark-white" type="button">Close</button>
                        <button class="btn primary">Upload dan Update</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>




<script>
	$(document).ready(function() {
		$('#sign-up').attr('disabled', true);
        $('#password').keyup(function() {
            var password = $('#password').val();
			// alert(checkStrength(password));
            if (checkStrength(password) == false) {
                $('#sign-up').attr('disabled', true);
            }
        });
        $('#confirm-password').blur(function() {
            if ($('#password').val() !== $('#confirm-password').val()) {
                $('#popover-cpassword').show();
                $('#sign-up').attr('disabled', true);
            } else {
                $('#popover-cpassword').hide();
				
				//cek
				var password = $('#password').val();
				// alert((password));

				if (checkStrength(password) == false) {
					$('#sign-up').attr('disabled', true);
				}else{
					$('#sign-up').attr('disabled', false);
				}
            }
        });

        function IsEmail(email) {
			{literal}
            var regex = /^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
			{/literal}
            if (!regex.test(email)) {
                return false;
            } else {
                return true;
            }
        }

        function checkStrength(password) {
            var strength = 0;

            //If password contains both lower and uppercase characters, increase strength value.
            if (password.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)) {
                strength += 1;
                $('.low-upper-case').addClass('text-success');
                $('.low-upper-case i').removeClass('fa-file-text').addClass('fa-check');
                $('#popover-password-top').addClass('hide');
            } else {
				strength -= 1;
                $('.low-upper-case').removeClass('text-success');
                $('.low-upper-case i').addClass('fa-file-text').removeClass('fa-check');
                $('#popover-password-top').removeClass('hide');
            }

            //If it has numbers and characters, increase strength value.
            if (password.match(/([a-zA-Z])/) && password.match(/([0-9])/)) {
                strength += 1;
                $('.one-number').addClass('text-success');
                $('.one-number i').removeClass('fa-file-text').addClass('fa-check');
                $('#popover-password-top').addClass('hide');
            } else {
				strength -= 1;
                $('.one-number').removeClass('text-success');
                $('.one-number i').addClass('fa-file-text').removeClass('fa-check');
                $('#popover-password-top').removeClass('hide');
            }

            //If it has one special character, increase strength value.
			//(!@#$%^&*).
            if (password.match(/([!,%,&,@,#,$,^,*,?,_,~])/)) {
                strength += 1;
                $('.one-special-char').addClass('text-success');
                $('.one-special-char i').removeClass('fa-file-text').addClass('fa-check');
                $('#popover-password-top').addClass('hide');
            } else {
				strength -= 1;
                $('.one-special-char').removeClass('text-success');
                $('.one-special-char i').addClass('fa-file-text').removeClass('fa-check');
                $('#popover-password-top').removeClass('hide');
            }

            if (password.length > 7) {
                strength += 1;
                $('.eight-character').addClass('text-success');
                $('.eight-character i').removeClass('fa-file-text').addClass('fa-check');
                $('#popover-password-top').addClass('hide');
            } else {
				strength -= 1;
                $('.eight-character').removeClass('text-success');
                $('.eight-character i').addClass('fa-file-text').removeClass('fa-check');
                $('#popover-password-top').removeClass('hide');
            }

            // If value is less than 2
            if (strength < 2) {
                $('#result').removeClass()
                $('#password-strength').addClass('progress-bar-danger');
                $('#result').addClass('text-danger').text('Sangat jelek');
                $('#password-strength').css('width', '10%');
				return false;
            } else if (strength == 2) {
                $('#result').addClass('good');
                $('#password-strength').removeClass('progress-bar-danger');
                $('#password-strength').addClass('progress-bar-warning');
                $('#result').addClass('text-warning').text('Jelek')
                $('#password-strength').css('width', '60%');
                return false;
            } else if (strength == 4) {
                $('#result').removeClass()
                $('#result').addClass('strong');
                $('#password-strength').removeClass('progress-bar-warning');
                $('#password-strength').addClass('progress-bar-success');
                $('#result').addClass('text-success').text('Bagus');
                $('#password-strength').css('width', '100%');
                return true;
            }
        }
    });
</script>